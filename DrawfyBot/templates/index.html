<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé® Drawfy - –†–∏—Å—É–π –∏ –¥–µ–ª–∏—Å—å</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style_local.css">
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        .welcome {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }
        
        .feature {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .feature-icon {
            font-size: 2em;
            min-width: 50px;
            text-align: center;
        }
        
        .quick-stats {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            text-align: center;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            flex: 1;
            margin: 0 10px;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –õ–æ–≥–æ—Ç–∏–ø –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
        <div class="logo">üé® Drawfy</div>
        <div class="welcome">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞!</h2>
            <p>–†–∏—Å—É–π, –¥–µ–ª–∏—Å—å —Ä–∞–±–æ—Ç–∞–º–∏, –≤–¥–æ—Ö–Ω–æ–≤–ª—è–π –¥—Ä—É–≥–∏—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤ –∏ —Ä–∞–∑–≤–∏–≤–∞–π —Å–≤–æ–π —Ç–∞–ª–∞–Ω—Ç.</p>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
        <div class="user-info" id="userInfo">
            <div class="avatar" id="userAvatar">üë§</div>
            <div>
                <h3 id="userName">–ì–æ—Å—Ç—å</h3>
                <p id="userStats">–ë–∞–ª–∞–Ω—Å: 100 üí∞ | –£—Ä–æ–≤–µ–Ω—å: 1</p>
            </div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div class="menu-grid">
            <a href="draw.html" class="menu-btn" onclick="trackClick('draw')">
                <span class="feature-icon">‚úèÔ∏è</span>
                <div>
                    <strong>–†–∏—Å–æ–≤–∞—Ç—å</strong>
                    <p style="font-size: 0.9em; margin-top: 5px;">–ù–æ–≤—ã–π —Ä–∏—Å—É–Ω–æ–∫</p>
                </div>
            </a>
            
            <a href="gallery.html" class="menu-btn" onclick="trackClick('gallery')">
                <span class="feature-icon">üñºÔ∏è</span>
                <div>
                    <strong>–ì–∞–ª–µ—Ä–µ—è</strong>
                    <p style="font-size: 0.9em; margin-top: 5px;">–†–∞–±–æ—Ç—ã —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</p>
                </div>
            </a>
            
            <a href="shop.html" class="menu-btn" onclick="trackClick('shop')">
                <span class="feature-icon">üõí</span>
                <div>
                    <strong>–ú–∞–≥–∞–∑–∏–Ω</strong>
                    <p style="font-size: 0.9em; margin-top: 5px;">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Ñ–æ–Ω—ã</p>
                </div>
            </a>
            
            <a href="profile.html" class="menu-btn" onclick="trackClick('profile')">
                <span class="feature-icon">üë§</span>
                <div>
                    <strong>–ü—Ä–æ—Ñ–∏–ª—å</strong>
                    <p style="font-size: 0.9em; margin-top: 5px;">–ú–æ–∏ —Ä–∞–±–æ—Ç—ã –∏ —Å—Ç–∞—Ç—ã</p>
                </div>
            </a>
            
            <div class="menu-btn" onclick="showTutorial()" style="cursor: pointer;">
                <span class="feature-icon">üìñ</span>
                <div>
                    <strong>–û–±—É—á–µ–Ω–∏–µ</strong>
                    <p style="font-size: 0.9em; margin-top: 5px;">–ö–∞–∫ —Ä–∏—Å–æ–≤–∞—Ç—å</p>
                </div>
            </div>
            
            <div class="menu-btn" onclick="shareApp()" style="cursor: pointer;">
                <span class="feature-icon">üì§</span>
                <div>
                    <strong>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</strong>
                    <p style="font-size: 0.9em; margin-top: 5px;">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π</p>
                </div>
            </div>
        </div>
        
        <!-- –ë—ã—Å—Ç—Ä–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="quick-stats" id="communityStats">
            <div class="stat-item">
                <span class="stat-number">0</span>
                <span class="stat-label">—Ä–∞–±–æ—Ç</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">0</span>
                <span class="stat-label">—Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">0</span>
                <span class="stat-label">–ª–∞–π–∫–æ–≤</span>
            </div>
        </div>
        
        <!-- –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ -->
        <div class="welcome" style="margin-top: 30px;">
            <h3>üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Drawfy:</h3>
            
            <div class="feature">
                <div class="feature-icon">üé®</div>
                <div>
                    <strong>–ü—Ä–æ—Å—Ç–æ–µ —Ä–∏—Å–æ–≤–∞–Ω–∏–µ</strong>
                    <p>–ö–∏—Å—Ç–∏, —Ü–≤–µ—Ç–∞, –ª–∞—Å—Ç–∏–∫ ‚Äî –≤—Å—ë –ø–æ–¥ —Ä—É–∫–æ–π</p>
                </div>
            </div>
            
            <div class="feature">
                <div class="feature-icon">‚≠ê</div>
                <div>
                    <strong>–°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞</strong>
                    <p>–ü–æ–ª—É—á–∞–π –ª–∞–π–∫–∏ –∏ –ø–æ–≤—ã—à–∞–π —É—Ä–æ–≤–µ–Ω—å</p>
                </div>
            </div>
            
            <div class="feature">
                <div class="feature-icon">üõí</div>
                <div>
                    <strong>–ú–∞–≥–∞–∑–∏–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤</strong>
                    <p>–ü–æ–∫—É–ø–∞–π –Ω–æ–≤—ã–µ –∫–∏—Å—Ç–∏ –∏ —Ñ–æ–Ω—ã</p>
                </div>
            </div>
            
            <div class="feature">
                <div class="feature-icon">üë•</div>
                <div>
                    <strong>–°–æ–æ–±—â–µ—Å—Ç–≤–æ</strong>
                    <p>–°–º–æ—Ç—Ä–∏ —Ä–∞–±–æ—Ç—ã –¥—Ä—É–≥–∏—Ö –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–π—Å—è</p>
                </div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞—á–∞–ª–∞ -->
        <div style="margin: 40px 0;">
            <a href="draw.html" class="btn" style="font-size: 1.2em; padding: 15px 40px;">
                üé® –ù–ê–ß–ê–¢–¨ –†–ò–°–û–í–ê–¢–¨
            </a>
        </div>
    </div>

    <script>
        // Telegram Web App API
        const tg = window.Telegram.WebApp;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram Web App
        function initTelegramApp() {
            if (typeof tg !== 'undefined' && tg.initDataUnsafe) {
                tg.expand();
                tg.ready();
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É Telegram
                tg.setHeaderColor('#667eea');
                tg.setBackgroundColor('#667eea');
                
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const user = tg.initDataUnsafe.user;
                if (user) {
                    document.getElementById('userName').textContent = 
                        user.first_name + (user.last_name ? ' ' + user.last_name : '');
                    
                    document.getElementById('userAvatar').textContent = 
                        user.first_name ? user.first_name[0].toUpperCase() : 'üë§';
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–µ—Ä–≤–µ—Ä–∞
                    loadUserData(user.id);
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if (tg.BackButton) {
                    tg.BackButton.show();
                    tg.BackButton.onClick(() => {
                        window.history.back();
                    });
                }
            } else {
                console.log('–ó–∞–ø—É—â–µ–Ω–æ –Ω–µ –≤ Telegram');
                // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ Telegram
                document.getElementById('userName').textContent = '–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('userStats').textContent = '–ë–∞–ª–∞–Ω—Å: 1000 üí∞ | –£—Ä–æ–≤–µ–Ω—å: 5';
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserData(userId) {
            fetch(`/api/get-user/${userId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.balance !== undefined) {
                        document.getElementById('userStats').textContent = 
                            `–ë–∞–ª–∞–Ω—Å: ${data.balance} üí∞ | –£—Ä–æ–≤–µ–Ω—å: ${data.level || 1}`;
                    }
                })
                .catch(error => {
                    console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                });
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
        function loadCommunityStats() {
            fetch('/api/get-drawings')
                .then(response => response.json())
                .then(data => {
                    const stats = document.getElementById('communityStats');
                    if (data.drawings && data.drawings.length > 0) {
                        const totalLikes = data.drawings.reduce((sum, drawing) => sum + (drawing.likes || 0), 0);
                        const totalDrawings = data.drawings.length;
                        
                        stats.innerHTML = `
                            <div class="stat-item">
                                <span class="stat-number">${totalDrawings}</span>
                                <span class="stat-label">—Ä–∞–±–æ—Ç</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">${Math.min(totalDrawings, 50)}</span>
                                <span class="stat-label">—Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">${totalLikes}</span>
                                <span class="stat-label">–ª–∞–π–∫–æ–≤</span>
                            </div>
                        `;
                    }
                })
                .catch(error => {
                    console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                });
        }
        
        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤
        function trackClick(action) {
            console.log(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª: ${action}`);
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        }
        
        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
        function shareApp() {
            if (tg && tg.shareLink) {
                tg.shareLink(
                    'https://t.me/drawfybot',
                    'üé® Drawfy - —Ä–∏—Å—É–π –∏ –¥–µ–ª–∏—Å—å!',
                    '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ Drawfy! –†–∏—Å—É–π, –¥–µ–ª–∏—Å—å —Ä–∞–±–æ—Ç–∞–º–∏ –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–π –¥—Ä—É–≥–∏—Ö!'
                );
            } else {
                alert('–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π: https://t.me/drawfybot');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
        function showTutorial() {
            const message = `
üé® *–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è Drawfy:*

1. *–†–∏—Å–æ–≤–∞–Ω–∏–µ:* 
   - –í—ã–±–µ—Ä–∏ –∫–∏—Å—Ç—å –∏ —Ü–≤–µ—Ç
   - –†–∏—Å—É–π –ø–∞–ª—å—Ü–µ–º –∏–ª–∏ –º—ã—à–∫–æ–π
   - –ò—Å–ø–æ–ª—å–∑—É–π –ª–∞—Å—Ç–∏–∫ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

2. *–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:*
   - –ù–∞–∂–º–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
   - –ü—Ä–∏–¥—É–º–∞–π –Ω–∞–∑–≤–∞–Ω–∏–µ
   - –†–∞–±–æ—Ç–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤ –≥–∞–ª–µ—Ä–µ–µ

3. *–ì–∞–ª–µ—Ä–µ—è:*
   - –°–º–æ—Ç—Ä–∏ —Ä–∞–±–æ—Ç—ã –¥—Ä—É–≥–∏—Ö
   - –°—Ç–∞–≤—å –ª–∞–π–∫–∏
   - –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–π

4. *–ú–∞–≥–∞–∑–∏–Ω:*
   - –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –ª–∞–π–∫–∞–º–∏
   - –ü–æ–∫—É–ø–∞–π –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
   - –û—Ç–∫—Ä—ã–≤–∞–π –æ—Å–æ–±—ã–µ —Ñ–æ–Ω—ã

*–£–¥–∞—á–∏ –≤ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–µ!* üöÄ
            `;
            
            if (tg && tg.showAlert) {
                tg.showAlert(message);
            } else {
                alert(message);
            }
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', () => {
            initTelegramApp();
            loadCommunityStats();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(loadCommunityStats, 30000);
        });
    </script>
</body>
</html>